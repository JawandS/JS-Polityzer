(("undefined"!=typeof self?self:this).webpackJsonp__wix_communities_blog_ooi=("undefined"!=typeof self?self:this).webpackJsonp__wix_communities_blog_ooi||[]).push([[1167],{27027:function(e,t,n){"use strict";n.d(t,{k:function(){return r}});var i=n(27762);const r=n.n(i)().createContext({isMobile:!1,experiments:{},languageDir:"ltr"})},88094:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return W}});var i=n(93173),r=n(23788),o=n(27762),s=n.n(o),a=n(60216),l=n.n(a),d=n(17607),c=n(4637),p=n(76939),u=n(27027),f=n(61544),h=n(18459),m=n(31047),w=n(40841),v=n.n(w),y=n(89962);n(87308),n(14555);function g(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return b(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return b(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var R=Object.defineProperty,E=Object.defineProperties,D=Object.getOwnPropertyDescriptors,_=Object.getOwnPropertySymbols,S=Object.prototype.hasOwnProperty,N=Object.prototype.propertyIsEnumerable,I=function(e,t,n){return t in e?R(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n},P=function(e,t){for(var n in t||(t={}))S.call(t,n)&&I(e,n,t[n]);if(_)for(var i,r=g(_(t));!(i=r()).done;){n=i.value;N.call(t,n)&&I(e,n,t[n])}return e},F=function(e,t){return E(e,D(t))},L=function(){function e(e){var t=this;this.window=e,this.readyPromise=new Promise((function(e){t.window.AdobeDC?e():t.window.document.addEventListener("adobe_dc_view_sdk.ready",(function(){e()}))}))}var t=e.prototype;return t.ready=function(){return this.readyPromise},t.previewFileWithURL=function(e,t,n){var i=this,r=t.url,o=t.fileName;return this.adobeDCView=new this.window.AdobeDC.View(e),new Promise((function(e){i.adobeDCView.previewFile({content:{location:{url:r}},metaData:{fileName:o}},F(P({},n),{showLeftHandPanel:!1,showAnnotationTools:!1,enableLinearization:!0})),e()}))},t.previewFileWithBlob=function(e,t,n){var i=this,r=t.url,o=t.fileName;return new Promise((function(t,s){fetch(new Request(r)).then((function(e){return e.blob()})).then((function(r){i.adobeDCView=new i.window.AdobeDC.View(e),i.adobeDCView.previewFile({content:{promise:Promise.resolve(r.arrayBuffer())},metaData:{fileName:o}},F(P({},n),{showLeftHandPanel:!1,showAnnotationTools:!1})),t()})).catch(s)}))},t.registerEventsHandler=function(e){this.adobeDCView.registerCallback(this.window.AdobeDC.View.Enum.CallbackType.EVENT_LISTENER,(function(t){e(t.type)}),{})},e}(),O=function(e){return e[e.NONE=0]="NONE",e[e.PENDING=1]="PENDING",e[e.LOADING_FILE=2]="LOADING_FILE",e[e.READY=3]="READY",e[e.ERROR=4]="ERROR",e}(O||{}),U={FULL:"",MINI:"SIZED_CONTAINER"},x="NONE",A={da:"da-DK",nl:"nl-NL",en:"en-US",fi:"fi-FI",fr:"fr-FR",de:"de-DE",it:"it-IT",ja:"ja-JP",no:"nb-NO",pt:"pt-BR",es:"es-ES",sv:"sv-SE",cs:"cs-CZ",ko:"ko-KR",pl:"pl-PL",ru:"ru-RU",tr:"tr-TR",zh:"zg-CN"},C={APP_RENDERING_DONE:3,PDF_VIEWER_OPEN:2,APP_RENDERING_FAILED:4},k="vSLOy",z="QEyvx";function T(e){var t,n=e.status,i=e.setStatus,r=e.fileData,a=e.config,l=a.clientId,d=a.locale,c=void 0===d?"en":d,p=e.pdfSettings,u=(0,o.useState)(void 0),f=u[0],h=u[1];f||h("ricos-pdf-viewer-"+Math.floor(1e4*Math.random()));var m=p||{},w=m.viewMode,y=void 0===w?x:w,g=m.disableDownload,b=void 0!==g&&g,R=m.disablePrint,E=void 0!==R&&R,D=function(e){console.log(e),i(O.ERROR)},_=function(e){var t=C[e];t&&t!==n&&i(t)};(0,o.useEffect)((function(){var e=y!==x?O.PENDING:O.NONE;n!==e&&i(e)}),[e.pdfSettings.viewMode,e.pdfSettings.disableDownload,e.pdfSettings.disablePrint]),(0,o.useEffect)((function(){if(window.document.getElementById("ricos-adobe-pdf-view-sdk")){if(n===O.PENDING){var e=new L(window);e.ready().then((function(){var t={embedMode:U[y],showDownloadPDF:!b,showPrintPDF:!E},n={clientId:l,divId:f,locale:A[c]};e.previewFileWithURL(n,r,t).then((function(){e.registerEventsHandler(_)})).catch(D)})).catch(D)}}else t=window,(i=t.document.createElement("script")).setAttribute("id","ricos-adobe-pdf-view-sdk"),i.setAttribute("src","https://documentcloud.adobe.com/view-sdk/main.js"),t.document.getElementsByTagName("body")[0].appendChild(i);var t,i}));var S=v()(z,((t={})[k]=n!==O.READY,t));return s().createElement("div",{id:f,className:S})}var j=Object.defineProperty,V=function(e,t,n){return function(e,t,n){t in e?j(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n}(e,"symbol"!=typeof t?t+"":t,n),n},M=320,$=140,G=100,W=function(e){function t(t){var n;n=e.call(this,t)||this,V((0,i.Z)(n),"isInResizeRange",(function(e){var t,i;return(null==(i=null==(t=n.fileUploadViewerRef)?void 0:t.current)?void 0:i.clientWidth)<e})),V((0,i.Z)(n),"switchReadyIcon",(function(){return n.setState({showReadyIcon:!0},(function(){return setTimeout((function(){return n.setState({showReadyIcon:!1})}),2e3)}))})),V((0,i.Z)(n),"renderContainerWithoutLink",(function(){var e,t=n.props,i=t.tempDataPlaceHolder,r=t.componentData,o=i||r,a=o.name,l=o.type;return s().createElement("div",{className:v()(n.styles.file_upload_link,(e={},e[n.styles.width_three]=n.isInResizeRange(G),e))},n.renderViewerBody({name:a,type:l}))})),V((0,i.Z)(n),"renderIcon",(function(e){var t,i=n.props,r=i.isLoading,o=i.isMobile,a=i.componentData.error,l=n.state,d=l.showReadyIcon,c=l.resolvingUrl,p=l.pdfStatus,u=r||c||p===O.LOADING_FILE;return!u&&!d&&o||!o&&e?s().createElement(e,{styles:n.styles,className:v()(n.styles.file_upload_type_icon,(t={},t[n.styles.width_three]=n.isInResizeRange(G),t))}):s().createElement("div",{className:o?n.styles.mobile_status_icon:n.styles.file_upload_state},a?s().createElement(f.E,null):u?s().createElement(f.L,{className:n.styles.file_loader_icon}):d?s().createElement(f.R,null):!n.isInResizeRange(M)&&s().createElement(f.D,null))})),V((0,i.Z)(n),"sizeToString",(function(e){return e<1e3?e+"B":e<1e6?Math.round(e/1e3)+"KB":(e/1e6).toFixed(2)+"MB"})),V((0,i.Z)(n),"getExperiments",(function(){return n.props.experiments||n.context.experiments})),V((0,i.Z)(n),"onFileClick",(function(){var e,t;return null==(t=(e=n.props.helpers).onViewerAction)?void 0:t.call(e,y.yh,"Click")})),V((0,i.Z)(n),"onPDFStatusChange",(function(e){return n.setState({pdfStatus:e})}));var r=t.componentData,o=t.componentData,a=o.type,l=o.pdfSettings,d=t.settings.adobeAPIKey,p=(null==l?void 0:l.viewMode)||x;(0,c.Gu)(r,h),n.downloaderRef=s().createRef(),n.fileUploadViewerRef=s().createRef();var u="pdf"===a&&p!==x&&d?O.PENDING:O.NONE;return n.state={resolvedFileUrl:null,resolvingUrl:!1,currentWidth:0,pdfStatus:u},n}(0,r.Z)(t,e);var n=t.prototype;return n.componentWillReceiveProps=function(e){var t=e.componentData;e.settings.adobeAPIKey;var n=this.props.componentData;(0,d.isEqual)(t,n)||(0,c.Gu)(t,h),!e.isLoading&&this.props.isLoading&&this.switchReadyIcon()},n.componentDidMount=function(){var e=this;(null==window?void 0:window.ResizeObserver)&&(this.resizer=new ResizeObserver((0,d.debounce)((function(t){e.setState({currentWidth:Math.round(t[0].contentRect.width)})}),60)),this.resizer.observe(this.fileUploadViewerRef.current))},n.componentWillUnmount=function(){var e;null==(e=this.resizeObserver)||e.unobserve(this.fileUploadViewerRef.current)},n.getFileInfoString=function(e){var t=this.props,n=t.componentData,i=t.t,r=t.isLoading,o=t.tempDataPlaceHolder,s=this.state.resolvingUrl;if(n.error)return{infoString:i("UploadFile_Error_Generic_Item"),infoStyle:this.styles.file_upload_text_error};var a=i(r||s?"UploadFile_Viewer_Loader":"UploadFile_Viewer_Download",{fileType:null==e?void 0:e.toUpperCase()}),l=n.size||(null==o?void 0:o.size);return l&&(a=a+" \u2022 "+this.sizeToString(l)),{infoString:a,infoStyle:this.styles.file_upload_type}},n.renderViewerBody=function(e){var t,n,i=e.name,r=e.type,o=this.props.isMobile,a=function(e){if(!e||!e.includes("."))return e;var t=e.split(".");return t.slice(0,t.length-1).join(".")}(i),l=(0,f.g)(r),d=this.getFileInfoString(r),c=d.infoString,p=d.infoStyle;return s().createElement(s().Fragment,null,this.renderIcon(l),!o&&this.renderIcon(),!this.isInResizeRange(G)&&s().createElement("div",{className:v()(this.styles.file_upload_text_container,(t={},t[this.styles.width_two]=this.isInResizeRange($),t))},s().createElement("div",{className:this.styles.file_upload_name_container},!this.isInResizeRange($)&&s().createElement("div",{className:this.styles.file_upload_name},a),r&&s().createElement("div",{className:v()(this.styles.file_upload_extension,(n={},n[this.styles.width_one]=this.isInResizeRange(M),n))},"."+r)),s().createElement("div",{className:p},c)))},n.renderViewer=function(e){var t,n=this.props,i=n.componentData,r=i.name,o=i.type,a=i.error,l=n.tempDataPlaceHolder,d=this.props.settings.downloadTarget;return a||l?this.renderContainerWithoutLink():s().createElement("a",{href:e,target:d,className:v()(this.styles.file_upload_link,(t={},t[this.styles.width_three]=this.isInResizeRange(G),t)),onClick:this.onFileClick},this.renderViewerBody({name:r,type:o}))},n.renderFileUrlResolver=function(){var e,t=this,n=this.props,i=n.componentData,r=n.settings.resolveFileUrl,o=i.name,a=i.type;if(i.error)return this.renderContainerWithoutLink();var l=function(){t.state.resolvingUrl||(t.setState({resolvingUrl:!0}),r(i).then((function(e){t.setState({resolvedFileUrl:e,resolvingUrl:!1},t.switchReadyIcon),t.downloaderRef.current&&(t.downloaderRef.current.href=e,t.downloaderRef.current.download=o,t.downloaderRef.current.click())})))};return s().createElement("div",{onClick:l,onKeyDown:function(e){13===e.which&&l()},role:"button",tabIndex:0,className:v()(this.styles.file_upload_link,(e={},e[this.styles.width_three]=this.isInResizeRange(G),e))},this.renderViewerBody({name:o,type:a}))},n.renderAutoDownloadLinkRef=function(){var e=this.props.settings,t=e.resolveFileUrl,n=e.downloadTarget;if(!t)return null;var i=n||"_blank";return this.getExperiments(),s().createElement("a",{href:"#0",ref:this.downloaderRef,style:{display:"none"},target:i},s().createElement(s().Fragment,null))},n.render=function(){var e,t=this.props,n=t.componentData,i=t.componentData.pdfSettings,r=void 0===i?{}:i,o=t.theme,a=t.setComponentUrl,l=t.tempDataPlaceHolder,d=t.settings.adobeAPIKey,c=t.locale;t.iframeSandboxDomain;var u=this.state.pdfStatus;this.styles=this.styles||(0,p.y)({styles:f.f,theme:o});var h=n.url||this.state.resolvedFileUrl;null==a||a(h);var w=h||l?this.renderViewer(h):this.renderFileUrlResolver(),y="fileUploadViewer",g=(null==(e=this.getExperiments().enableFilePluginPDFViewer)?void 0:e.enabled)&&"undefined"!=typeof window&&h&&![O.ERROR].includes(u),b=v()(this.styles.file_upload_container,n.error&&this.styles.file_upload_error_container);return s().createElement(m.Z,{content:this.isInResizeRange(M)&&n.name,tooltipOffset:{y:25}},g?s().createElement("div",{"data-hook":y,ref:this.fileUploadViewerRef},s().createElement(T,{status:u,fileData:{url:h,fileName:n.name},setStatus:this.onPDFStatusChange,pdfSettings:r,config:{clientId:d,locale:c}}),![O.READY].includes(u)&&s().createElement("div",{className:b},w)):s().createElement("div",{"data-hook":y,ref:this.fileUploadViewerRef,className:b},w,this.renderAutoDownloadLinkRef()))},t}(o.PureComponent);V(W,"contextType",u.k),W.propTypes={isLoading:l().bool.isRequired,componentData:l().object.isRequired,tempDataPlaceHolder:l().object,settings:l().object,theme:l().object.isRequired,setComponentUrl:l().func,t:l().func,isMobile:l().bool,helpers:l().object,locale:l().string,iframeSandboxDomain:l().string,experiments:l().object},W.defaultProps={isLoading:!1,settings:{}}},45503:function(){},18459:function(e){"use strict";e.exports=JSON.parse('{"$schema":"http://json-schema.org/draft-07/schema#","$id":"https://wix-rich-content/file-upload-content-data-schema.json","type":"object","properties":{"config":{"$id":"/properties/config","type":"object","properties":{"size":{"$id":"/properties/config/properties/size","type":"string","title":"Size","default":"large","examples":["medium","small","large"]},"alignment":{"$id":"/properties/config/properties/alignment","type":"string","title":"The Alignment Schema ","default":"center","examples":["left","right","center"]},"width":{"$id":"/properties/config/properties/width","type":"string","title":"The Width Schema","default":"fit-content","examples":["fit-content","100px"]}}},"name":{"$id":"/properties/name","type":"string","title":"The File Name Schema","default":"","examples":["landscape.jpg"]},"type":{"$id":"/properties/type","type":"string","title":"The File Type Schema","default":"","examples":["jpg"]},"url":{"$id":"/properties/url","type":"string","title":"The File URL Schema","default":"","examples":["http://example.com/landscape.jpg"]},"id":{"$id":"/properties/id","type":"string","title":"The File ID Schema ","default":"","examples":["d3dd72_e4310321765e48f44803b92424d5edb8"]},"size":{"$id":"/properties/size","type":["number","string"],"title":"The File size Schema ","default":"","examples":["15000",15000]},"pdfSettings":{"$id":"/properties/pdfSettings","type":"object","properties":{"viewMode":{"$id":"/properties/pdfSettings/properties/viewMode","type":"string","title":"The File PDF view modes Schema ","default":"","examples":["NONE","FULL","MINI"]},"disableDownload":{"$id":"/properties/pdfSettings/properties/disableDownload","type":"boolean","title":"The File disable download PDF property Schema ","default":""},"disablePrint":{"$id":"/properties/pdfSettings/properties/disablePrint","type":"boolean","title":"The File disable print PDF property Schema ","default":""}}}}}')}}]);
//# sourceMappingURL=file-upload-viewer.chunk.min.js.map